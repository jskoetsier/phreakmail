# Rspamd antivirus configuration for Comodo

# Comodo scanner configuration
comodo {
  # Socket to connect to Comodo daemon
  servers = "comodo:3310";

  # Scan attachments and messages
  scan_mime_parts = true;
  scan_text_mime = true;
  scan_image_mime = true;

  # Symbols to add
  symbol = "COMODO_VIRUS";
  symbols {
    # Symbol for clean messages
    clean = "COMODO_CLEAN";

    # Symbol for infected messages
    infected = "COMODO_VIRUS";

    # Symbol for scan errors
    scan_error = "COMODO_SCAN_ERROR";

    # Symbol for timeouts
    timeout = "COMODO_TIMEOUT";
  }

  # Patterns to match specific virus types
  patterns {
    # Add specific virus patterns here if needed
    JUST_EICAR = "^Eicar-Test-Signature$";
  }

  # Action if virus is found
  action = "reject";

  # Log clean results
  log_clean = false;

  # Timeout for scanning
  timeout = 15.0;

  # Maximum size to scan
  max_size = 25000000; # 25MB

  # Type of scanner
  type = "clamav"; # Comodo uses the same protocol as ClamAV
}

# Disable ClamAV scanner
clamav {
  enabled = false;
}
